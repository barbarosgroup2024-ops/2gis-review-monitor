# üóÑÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Supabase –¥–ª—è 2GIS Review Monitor

## –ü—Ä–æ–±–ª–µ–º–∞

–ï—Å–ª–∏ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤—ã –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫—É **"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏"**, —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö Supabase –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ (5 –º–∏–Ω—É—Ç)

### –®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ Supabase SQL Editor

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞: **https://supabase.com/dashboard**
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç: **`fxjgmulnkiolxgsrfmry`**
3. –í –ª–µ–≤–æ–º –º–µ–Ω—é –Ω–∞–∂–º–∏—Ç–µ **"SQL Editor"**

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã

–í—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å:

```sql
SELECT table_name
FROM information_schema.tables
WHERE table_schema = 'public';
```

**–ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü –Ω–µ—Ç –∏–ª–∏ –∏—Ö –º–∞–ª–æ** ‚Üí –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ –®–∞–≥—É 3

**–ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü—ã –µ—Å—Ç—å (users, companies, reviews, subscriptions)** ‚Üí –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ –®–∞–≥—É 4

### –®–∞–≥ 3: –°–æ–∑–¥–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—ã (–µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç)

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª: **`database/schema_fixed.sql`**
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **–í–°–Å** —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞
3. –í—Å—Ç–∞–≤—å—Ç–µ –≤ SQL Editor –≤ Supabase
4. –ù–∞–∂–º–∏—Ç–µ **"Run"** (–∏–ª–∏ Ctrl+Enter)
5. –î–æ–∂–¥–∏—Ç–µ—Å—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 10-20 —Å–µ–∫—É–Ω–¥)

‚úÖ –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å: **"Success. No rows returned"**

### –®–∞–≥ 4: –ò—Å–ø—Ä–∞–≤—å—Ç–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü—ã —É–∂–µ –µ—Å—Ç—å)

–ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü—ã —É–∂–µ —Å–æ–∑–¥–∞–Ω—ã, –Ω–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç–æ—Ç SQL:

```sql
-- –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏
DROP POLICY IF EXISTS "Users can view own data" ON users;
DROP POLICY IF EXISTS "Users can update own data" ON users;
DROP POLICY IF EXISTS "Users can view own subscriptions" ON subscriptions;
DROP POLICY IF EXISTS "Users can view own companies" ON companies;
DROP POLICY IF EXISTS "Users can insert own companies" ON companies;
DROP POLICY IF EXISTS "Users can update own companies" ON companies;
DROP POLICY IF EXISTS "Users can delete own companies" ON companies;
DROP POLICY IF EXISTS "Users can view reviews of own companies" ON reviews;

-- –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏ (—Ä–∞–∑—Ä–µ—à–∞—é—Ç —Ä–∞–±–æ—Ç—É —á–µ—Ä–µ–∑ service_role)
CREATE POLICY "Service role can do everything on users" ON users
  FOR ALL
  USING (true)
  WITH CHECK (true);

CREATE POLICY "Service role can do everything on subscriptions" ON subscriptions
  FOR ALL
  USING (true)
  WITH CHECK (true);

CREATE POLICY "Service role can do everything on companies" ON companies
  FOR ALL
  USING (true)
  WITH CHECK (true);

CREATE POLICY "Service role can do everything on reviews" ON reviews
  FOR ALL
  USING (true)
  WITH CHECK (true);
```

–ù–∞–∂–º–∏—Ç–µ **"Run"**

‚úÖ –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å: **"Success. No rows returned"**

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–±–ª–∏—Ü—ã

–í—ã–ø–æ–ª–Ω–∏—Ç–µ:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∞–±–ª–∏—Ü—ã users
SELECT * FROM users LIMIT 1;

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∞–±–ª–∏—Ü—ã subscriptions
SELECT * FROM subscriptions LIMIT 1;

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∞–±–ª–∏—Ü—ã companies
SELECT * FROM companies LIMIT 1;

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∞–±–ª–∏—Ü—ã reviews
SELECT * FROM reviews LIMIT 1;
```

–ï—Å–ª–∏ –≤—ã –≤–∏–¥–∏—Ç–µ **"Success. No rows returned"** –∏–ª–∏ –¥–∞–Ω–Ω—ã–µ - –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç! ‚úÖ

–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫—É - –∑–Ω–∞—á–∏—Ç —Ç–∞–±–ª–∏—Ü—ã –Ω–µ —Å–æ–∑–¥–∞–Ω—ã, –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –∫ –®–∞–≥—É 3.

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä

```powershell
cd "c:\Users\dasta\OneDrive\–î–æ–∫—É–º–µ–Ω—Ç—ã\2 GIS"
npm run dev
```

### 2. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä

```
http://localhost:3000/register
```

### 3. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å

- **–ò–º—è:** Test User
- **Email:** test@example.com
- **–ü–∞—Ä–æ–ª—å:** 123456

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

**‚úÖ –£—Å–ø–µ—Ö:** –í—ã –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É

**‚ùå –û—à–∏–±–∫–∞:** –°–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Supabase

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏—Å—å:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
SELECT id, email, name, status, created_at
FROM users
WHERE email = 'test@example.com';

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏
SELECT u.email, s.plan, s.start_date, s.end_date, s.status
FROM subscriptions s
JOIN users u ON s.user_id = u.id
WHERE u.email = 'test@example.com';
```

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:

- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å email `test@example.com`
- ‚úÖ –ü–æ–¥–ø–∏—Å–∫—É —Å –ø–ª–∞–Ω–æ–º `trial` –Ω–∞ 7 –¥–Ω–µ–π

---

## üÜò –ï—Å–ª–∏ –≤—Å—ë –µ—â—ë –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–û—Ç–∫—Ä–æ–π—Ç–µ `.env` –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:

```env
SUPABASE_URL=https://fxjgmulnkiolxgsrfmry.supabase.co
SUPABASE_SERVICE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞

–í –∫–æ–Ω—Å–æ–ª–∏, –≥–¥–µ –∑–∞–ø—É—â–µ–Ω —Å–µ—Ä–≤–µ—Ä, –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:

```
üöÄ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Supabase (PostgreSQL)
‚úÖ Telegram –±–æ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
üöÄ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 5000
```

–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫–∏ - —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏—Ö –∏ —Å–æ–æ–±—â–∏—Ç–µ –º–Ω–µ.

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Console**
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ, –∫–∞–∫–∏–µ –æ—à–∏–±–∫–∏ –ø–æ—è–≤–ª—è—é—Ç—Å—è

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É –≤–∞—Å –±—É–¥—É—Ç —Ç–∞–±–ª–∏—Ü—ã:

| –¢–∞–±–ª–∏—Ü–∞         | –û–ø–∏—Å–∞–Ω–∏–µ               |
| --------------- | ---------------------- |
| `users`         | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã   |
| `subscriptions` | –ü–æ–¥–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| `companies`     | –ö–æ–º–ø–∞–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| `reviews`       | –û—Ç–∑—ã–≤—ã —Å 2GIS          |

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**Row Level Security (RLS)** –≤–∫–ª—é—á–µ–Ω, –Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Ç–∞–∫, —á—Ç–æ–±—ã:

- ‚úÖ Service role (–≤–∞—à backend) –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å –≤—Å—ë
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞—â–∏—â–µ–Ω—ã –æ—Ç –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ —á–µ—Ä–µ–∑ API

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç

- [ ] –û—Ç–∫—Ä—ã–ª Supabase SQL Editor
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã
- [ ] –í—ã–ø–æ–ª–Ω–∏–ª `schema_fixed.sql` (–µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü –Ω–µ –±—ã–ª–æ)
- [ ] –ò—Å–ø—Ä–∞–≤–∏–ª –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü—ã –±—ã–ª–∏)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —Ç–∞–±–ª–∏—Ü—ã –∑–∞–ø—Ä–æ—Å–æ–º SELECT
- [ ] –ó–∞–ø—É—Å—Ç–∏–ª –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
- [ ] –£—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª—Å—è
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª –¥–∞–Ω–Ω—ã–µ –≤ Supabase

---

**–í—Ä–µ–º—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏: ~5 –º–∏–Ω—É—Ç**

**–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å!** ‚úÖ
